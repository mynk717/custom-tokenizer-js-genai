<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Tokenizer JS</title>
    <!-- Tailwind CSS CDN for quick styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FAFAFA; /* Palette: Off-White Background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 24px;
            color: #000000; /* Palette: Primary Text */
        }
        .container {
            background-color: #ffffff;
            border-radius: 1.25rem;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            padding: 3rem;
            width: 100%;
            max-width: 900px;
        }
        /* Heading Shadow Box Style */
        .heading-shadow-box {
            display: inline-block; /* Makes the background and shadow fit the text content */
            padding: 0.75rem 1.5rem; /* Padding around the text */
            background-color: #FFFFFF; /* White background for the box */
            border-radius: 0.75rem; /* Rounded corners for the box */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Subtle shadow for the box */
            margin-bottom: 2rem; /* Space below the heading box */
            /* Center the inline-block element */
            margin-left: auto;
            margin-right: auto;
            color: #C5C5C5; /* Palette: Primary Text for heading */
        }

        textarea {
            min-height: 160px;
            resize: vertical;
            border-radius: 0.6rem;
            padding: 1rem;
            border: 1px solid #e0e0e0; /* Softer border to match new palette */
            color: #000000; /* Primary Text */
            background-color: #FFFFFF; /* White background for textareas */
        }
        button {
            transition: background-color 0.2s, transform 0.1s;
            border-radius: 0.8rem;
            padding: 0.8rem 1.6rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        button:hover {
            transform: translateY(-2px);
        }
        .primary-btn {
            background-color: #673AB7; /* Palette: Deep Purple Primary Button */
            color: #FFFFFF; /* Palette: White Button Text */
            border: none;
        }
        .primary-btn:hover {
            background-color: #5E35B1; /* Slightly darker purple on hover */
        }
        .secondary-btn {
            background-color: #F0F0F0; /* Lighter gray for secondary buttons */
            color: #757575; /* Secondary Text */
            border: 1px solid #bdbdbd; /* Soft border */
        }
        .secondary-btn:hover {
            background-color: #e0e0e0;
        }
        .message-box {
            padding: 1.25rem;
            border-radius: 0.75rem;
            margin-top: 2rem;
            font-size: 1rem;
            display: none;
            font-weight: 500;
        }
        .message-box.success {
            background-color: #dcedc8; /* Light green */
            color: #33691e; /* Dark green */
            border: 1px solid #c5e1a5;
        }
        .message-box.error {
            background-color: #ffcdd2; /* Light red */
            color: #c62828; /* Dark red */
            border: 1px solid #ef9a9a;
        }
        .message-box.info {
            background-color: #e3f2fd; /* Light blue */
            color: #1565c0; /* Dark blue */
            border: 1px solid #90caf9;
        }
        /* Color adjustments for text elements and instructions box */
        label, .instructions-text {
            color: #000000; /* Palette: Primary Text */
        }
        .text-gray-700 { /* This class was used for instructions list items and heading text, now mapped to palette */
            color: #757575; /* Palette: Secondary Text for general gray text */
        }
        .text-indigo-600 { /* This was for vocab size, changing to Accent */
            color: #FFEB3B; /* Palette: Accent Bright Yellow */
            text-shadow: 0 0 5px rgba(255, 235, 59, 0.5); /* Subtle glow for accent */
        }
        .focus\:ring-indigo-500:focus {
            --tw-ring-color: #FFEB3B; /* Palette: Accent for focus ring */
        }
        .focus\:border-indigo-500:focus {
            border-color: #FFEB3B; /* Palette: Accent for focus border */
        }
        .bg-blue-50 { /* Background of instructions box */
            background-color: #F8F8F8; /* A light, clean background for the instructions box */
            border: 1px solid #e0e0e0; /* Subtle border for instructions box */
        }
        .border-blue-200 { /* Border of instructions box - overridden by bg-blue-50's border */
            border-color: #e0e0e0; /* Ensure consistency if used elsewhere */
        }
        .text-blue-800 { /* Heading inside instructions box */
            color: #4527A0; /* A darker shade of Deep Purple for emphasis */
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="text-center">
            <!-- Heading with Shadow Box -->
            <div class="heading-shadow-box">
                <h1 class="text-3xl">Custom Tokenizer JS</h1>
            </div>
        </div>

        <!-- Instructions Section -->
        <div class="mb-8 bg-blue-50 p-5 rounded-xl border border-blue-200">
            <h2 class="text-xl font-semibold text-blue-800 mb-3">Instructions</h2>
            <ul class="list-disc list-inside text-gray-700 space-y-1 instructions-text">
                <li><strong>1. Learn Vocabulary:</strong> Load or paste your demo corpus into the "Corpus for Vocabulary Learning" area and click "Learn Vocabulary". This will build the tokenizer's vocabulary.</li>
                <li><strong>2. Encode Text:</strong> Type or paste text into the "Text to Encode" area and click "Encode Text". The token IDs will appear below.</li>
                <li><strong>3. Decode Tokens:</strong> Paste token IDs (comma-separated numbers) into the "Token IDs to Decode" area and click "Decode Tokens". The original text will be reconstructed.</li>
                <li>Your vocabulary is saved in your browser's local storage.</li>
            </ul>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Corpus Input -->
            <div>
                <label for="corpusInput" class="block text-gray-700 font-medium mb-2">Corpus for Vocabulary Learning</label>
                <textarea id="corpusInput" class="w-full border focus:ring-indigo-500 focus:border-indigo-500" placeholder="Paste your text corpus here or it will be pre-filled from demo_corpus.txt"></textarea>
                <button id="learnVocabBtn" class="primary-btn w-full mt-5">Learn Vocabulary</button>
            </div>

            <!-- Text to Encode -->
            <div>
                <label for="textToEncodeInput" class="block text-gray-700 font-medium mb-2">Text to Encode</label>
                <textarea id="textToEncodeInput" class="w-full border focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter text to encode"></textarea>
                <button id="encodeTextBtn" class="primary-btn w-full mt-5">Encode Text</button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
            <!-- Encoded Tokens Output -->
            <div>
                <label for="encodedTokensOutput" class="block text-gray-700 font-medium mb-2">Encoded Tokens (IDs)</label>
                <textarea id="encodedTokensOutput" class="w-full border bg-gray-50 cursor-not-allowed" readonly></textarea>
            </div>

            <!-- Token IDs to Decode -->
            <div>
                <label for="tokensToDecodeInput" class="block text-gray-700 font-medium mb-2">Token IDs to Decode (comma-separated)</label>
                <textarea id="tokensToDecodeInput" class="w-full border focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter comma-separated token IDs to decode"></textarea>
                <button id="decodeTokensBtn" class="primary-btn w-full mt-5">Decode Tokens</button>
            </div>
        </div>

        <!-- Decoded Text Output -->
        <div class="mt-8">
            <label for="decodedTextOutput" class="block text-gray-700 font-medium mb-2">Decoded Text</label>
            <textarea id="decodedTextOutput" class="w-full border bg-gray-50 cursor-not-allowed" readonly></textarea>
        </div>

        <!-- Vocabulary Info & Message Box -->
        <div class="mt-8 text-center">
            <p class="text-lg font-semibold text-gray-800">Current Vocabulary Size: <span id="vocabSizeDisplay" class="text-indigo-600">0</span></p>
            <div id="messageBox" class="message-box"></div>
        </div>
    </div>

    <!-- Link to your tokenizer.js file -->
    <script src="tokenizer.js"></script>
    <script>
        // --- DOM Elements and Event Listeners (remains in index.html for UI interaction) ---
        const corpusInput = document.getElementById('corpusInput');
        const learnVocabBtn = document.getElementById('learnVocabBtn');
        const textToEncodeInput = document.getElementById('textToEncodeInput');
        const encodeTextBtn = document.getElementById('encodeTextBtn');
        const encodedTokensOutput = document.getElementById('encodedTokensOutput');
        const tokensToDecodeInput = document.getElementById('tokensToDecodeInput');
        const decodeTokensBtn = document.getElementById('decodeTokensBtn');
        const decodedTextOutput = document.getElementById('decodedTextOutput');
        const vocabSizeDisplay = document.getElementById('vocabSizeDisplay');
        const messageBox = document.getElementById('messageBox');

        // Initialize tokenizer instance (from tokenizer.js)
        const tokenizer = new Tokenizer();

        /**
         * Displays a temporary message to the user.
         * @param {string} message - The message to display.
         * @param {string} type - 'success', 'error', or 'info' for styling.
         */
        function showMessage(message, type) {
            messageBox.textContent = message;
            messageBox.className = `message-box ${type}`; // Reset classes and add new type
            messageBox.style.display = 'block';
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 5000); // Hide after 5 seconds
        }

        /**
         * Updates the displayed vocabulary size.
         */
        function updateVocabSizeDisplay() {
            vocabSizeDisplay.textContent = tokenizer.getVocabSize();
        }

        // --- Event Handlers ---

        learnVocabBtn.addEventListener('click', () => {
            const corpus = corpusInput.value.trim();
            if (corpus) {
                tokenizer.learnVocab(corpus);
                updateVocabSizeDisplay();
                showMessage('Vocabulary learned and saved! 😊', 'success');
            } else {
                showMessage('Please provide some text to learn vocabulary from.', 'info');
            }
        });

        encodeTextBtn.addEventListener('click', () => {
            const text = textToEncodeInput.value.trim();
            if (text) {
                if (tokenizer.getVocabSize() <= Object.keys(Tokenizer.SPECIAL_TOKENS).length) {
                    showMessage('Please learn a vocabulary first before encoding! 🙏', 'info');
                    return;
                }
                const encoded = tokenizer.encode(text);
                encodedTokensOutput.value = encoded.join(', ');
                tokensToDecodeInput.value = encoded.join(', '); // Pre-fill for easy decoding
                showMessage('Text encoded successfully! �', 'success');
            } else {
                showMessage('Please enter text to encode.', 'info');
            }
        });

        decodeTokensBtn.addEventListener('click', () => {
            const tokenIdsString = tokensToDecodeInput.value.trim();
            if (tokenIdsString) {
                if (tokenizer.getVocabSize() <= Object.keys(Tokenizer.SPECIAL_TOKENS).length) {
                    showMessage('Please learn a vocabulary first or load existing one before decoding! 🙏', 'info');
                    return;
                }
                try {
                    const tokenIds = tokenIdsString.split(',').map(id => parseInt(id.trim(), 10)).filter(id => !isNaN(id));
                    if (tokenIds.length === 0) {
                        showMessage('No valid token IDs found in input. Please enter comma-separated numbers.', 'error');
                        return;
                    }
                    const decoded = tokenizer.decode(tokenIds);
                    decodedTextOutput.value = decoded;
                    showMessage('Tokens decoded successfully! 🎉', 'success');
                } catch (e) {
                    console.error('Error decoding tokens:', e);
                    showMessage('Error: Invalid token ID format. Please use comma-separated numbers.', 'error');
                }
            } else {
                showMessage('Please enter token IDs to decode.', 'info');
            }
        });

        // --- Initial Load ---
        window.addEventListener('load', () => {
            // Load corpus from demo_corpus.txt
            fetch('demo_corpus.txt')
                .then(response => response.text())
                .then(text => {
                    corpusInput.value = text;
                    // Attempt to load vocab on page load, if successful, show a message
                    if (tokenizer.getVocabSize() > Object.keys(Tokenizer.SPECIAL_TOKENS).length) {
                        showMessage(`Vocabulary with ${tokenizer.getVocabSize()} tokens loaded from localStorage.`, 'info');
                    } else {
                        showMessage('No existing vocabulary found. Please learn a new one. 🤔', 'info');
                    }
                    updateVocabSizeDisplay(); // Update display after potential load
                })
                .catch(error => {
                    console.error('Error loading demo_corpus.txt:', error);
                    showMessage('Error loading demo corpus. Please paste text manually. ⚠️', 'error');
                    updateVocabSizeDisplay(); // Still update display even if corpus load fails
                });
        });
    </script>
</body>
</html>
�